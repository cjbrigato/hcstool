{
  "_comment": [
    "Enhanced Session Mode RDP — this is what Windows Sandbox uses.",
    "vmconnect.exe connects via VMBus, NOT TCP. No network adapter needed.",
    "Requires: guest OS has RDP + Enhanced Session Mode support (Win10/11 Pro+).",
    "Connect with: vmconnect.exe localhost <vm-guid>",
    "GUESSES marked with [?] — may need adjustment after dump of real Sandbox VM."
  ],
  "Owner": "hcstool",
  "SchemaVersion": {
    "Major": 2,
    "Minor": 1
  },
  "ShouldTerminateOnLastHandleClosed": false,
  "VirtualMachine": {
    "StopOnReset": true,
    "Chipset": {
      "Uefi": {
        "BootThis": {
          "DevicePath": "Primary",
          "DeviceType": "ScsiDrive",
          "DiskNumber": 0
        }
      }
    },
    "ComputeTopology": {
      "Memory": {
        "SizeInMB": 4096,
        "AllowOvercommit": true
      },
      "Processor": {
        "Count": 4
      }
    },
    "Devices": {
      "Scsi": {
        "Primary": {
          "Attachments": {
            "0": {
              "Type": "VirtualDisk",
              "Path": "C:\\path\\to\\boot.vhdx"
            }
          }
        }
      },

      "EnhancedModeVideo": {
        "_comment": "Enables RDP-over-VMBus (Enhanced Session Mode). This is the key device.",
        "ConnectionOptions": {
          "AccessSids": [
            "S-1-5-21-0-0-0-1000"
          ],
          "NamedPipe": "\\\\.\\pipe\\intvm-rdp-{vm-guid}"
        }
      },

      "VideoMonitor": {
        "_comment": "[?] May control initial resolution for the RDP canvas.",
        "HorizontalResolution": 1920,
        "VerticalResolution": 1080
      },

      "Keyboard": {
        "_comment": "Synthetic keyboard — needed for input through Enhanced Session."
      },

      "Mouse": {
        "_comment": "Synthetic mouse — needed for input through Enhanced Session."
      },

      "GuestInterface": {
        "_comment": "[?] Guest integration services — may be needed for session negotiation."
      }
    },

    "GuestState": {
      "_comment": "[?] Sandbox may set runtime state path here for fast-clone scenarios."
    }
  }
}
